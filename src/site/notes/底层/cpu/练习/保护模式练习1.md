---
{"dg-publish":true,"dg-path":"笔记/保护模式练习1.md","permalink":"/笔记/保护模式练习1/","noteIcon":"1","created":"","updated":""}
---


1. 在 [windbg](https://so.csdn.net/so/search?q=windbg&spm=1001.2101.3001.7020) 中查看 GDT 表的基址和长度：
```windbg
r gdtr
r gtrl
```
![../../../图片/保护模式练习1.png](/img/user/%E5%9B%BE%E7%89%87/%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E7%BB%83%E4%B9%A01.png)
2. 分别使用 dd dq 指令查看 GDT 表：
> [!note] windbg 指令
r 查看寄存器 
dd 以四字节为一组读取并显示数据
dq 以八字节为一组读取并显示数据

使用 dd 时，高位在后面，使用 dq 时，高位在前面。
![../../../图片/1-保护模式练习1.png](/img/user/%E5%9B%BE%E7%89%87/1-%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F%E7%BB%83%E4%B9%A01.png)


3. 段描述符查分实验：
![../../../图片/段描述符1.png|段描述符](/img/user/%E5%9B%BE%E7%89%87/%E6%AE%B5%E6%8F%8F%E8%BF%B0%E7%AC%A61.png)

- index=1 的描述符：`00CF9B00-0000FFFF`
  `00` base 24-31，段地址高 8 位
  `C` 1100，G 位=1 段界限以 4 KB 为单位，D/B 位=1 对于代码段，指示32位的有效地址或者操作数，L=0 32位模式，AVL=0 操作系统使用。
  `F` 1111，Limit，段界限 16-19 位
  `9` 1001，P=1 有效，DPL=00 最高权限，S=1 代码或数据段
  `B` 1011，可读可执行代码段
  `00` 段地址 16-23 位
  `0000` 段地址 0-15 位
  `FFFF` 段界限 0-15 位


4. 段选择子拆分实验：
`2B` 0010 1011：RPL=3，TI=0，Index=5，找第 6 个 GDT 表中的描述符。
`23` 0010 0011：RPL=3，TI=0，Index=4，找第 5 个 GDT 表中的描述符。
`53` 0101 0011：RPL=3，TI=0，Index=10，找第 11 个 GDT 表中的描述符。

5. 查 GDT 表如何快速确定哪个描述符的 P 位为0 或者为1
`00cf9300-0000ffff` 以该描述符为例：
高地址从右到左第4位，大于等于8则 P 位有效。

6. 查 GDT 表如何快速确定哪个描述符的 G 位为0 或者为1
高地址从右到左第6位，大于等于8则 G 位有效。















